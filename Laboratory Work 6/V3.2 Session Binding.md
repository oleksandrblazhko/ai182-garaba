### V3.2 Прив'язка сеансу

|#|Опис|L1|L2|L3|CWE|NIST|
|----|----|----|----|----|----|----|
|3.2.1|Перевірте, чи програма генерує новий маркер сеансу для користувача аутентифікація.(C6)|✓|✓|✓|384|7.1|
|3.2.2|Переконайтеся, що маркери сеансу мають щонайменше 64 біти ентропії. (C6) |✓ |✓ |✓ |331 |7.1|
|3.2.3|Переконайтеся, що програма зберігає лише маркери сеансу у браузері за допомогою безпечні методи, такі як належним чином захищені файли cookie (див. розділ 3.4) або сховище сеансу HTML 5.|✓|✓|✓|539|7.1|
|3.2.4|Переконайтеся, що маркери сеансу генеруються за допомогою затверджених криптографічні алгоритми. (C6)||✓|✓|331|7.1|

## C6 Впровадити цифрову ідентифікацію

### Oпис
Цифрова ідентифікація — це унікальне представлення користувача (або іншого суб’єкта), коли він бере участь у онлайн-транзакції. Автентифікація — це процес підтвердження того, що особа чи організація є тими, за кого себе видають. Керування сеансами — це процес, за допомогою якого сервер підтримує стан автентифікації користувачів, щоб користувач міг продовжувати використовувати систему без повторної автентифікації. Спеціальна публікація NIST 800-63B: Рекомендації щодо цифрової ідентифікації (автентифікація та керування життєвим циклом) містить надійні вказівки щодо впровадження цифрової ідентифікації, автентифікації та керування сеансами.

Нижче наведено деякі рекомендації щодо безпечного впровадження.

### Рівні автентифікації
NIST 800-63b описує три рівні гарантії автентифікації, які називаються рівнем гарантії автентифікації (AAL). Рівень AAL 1 зарезервовано для програм із меншим ризиком, які не містять ідентифікаційної інформації чи інших особистих даних. На рівні 1 AAL потрібна лише однофакторна автентифікація, як правило, за допомогою пароля.

### Рівень 1: Паролі
Паролі дійсно дуже важливі. Нам потрібна політика, нам потрібно зберігати їх безпечно, нам потрібно іноді дозволяти користувачам скидати їх.

### Вимоги до пароля
Паролі повинні відповідати принаймні таким вимогам:

мати довжину не менше 8 символів, якщо також використовується багатофакторна автентифікація (MFA) та інші елементи керування. Якщо MFA неможливо, його слід збільшити принаймні до 10 символів
усі друковані символи ASCII, а також символ пробілу повинні бути прийнятними в запам’ятованих секретах
заохочуйте використання довгих паролів і парольних фраз
скасувати вимоги до складності, оскільки вони виявилися обмежено ефективними. Замість цього рекомендується прийняти MFA або пароль більшої довжини
переконайтеся, що використовувані паролі не є типовими паролями, які вже були розкриті під час попереднього зламу. Ви можете заблокувати 1000 чи 10 000 найпоширеніших паролів, які відповідають наведеним вище вимогам щодо довжини та містяться в зламаних списках паролів. Наступне посилання містить найпоширеніші паролі: https://github.com/danielmiessler/SecLists/tree/master/Passwords.
Впровадити безпечний механізм відновлення пароля
Як правило, програма має механізм, за допомогою якого користувач може отримати доступ до свого облікового запису, якщо він забуде свій пароль. Хороший робочий процес для функції відновлення пароля передбачає використання елементів багатофакторної автентифікації. Наприклад, він може задати таємне запитання – те, що вони знають, а потім надіслати згенерований маркер на пристрій – те, що їм належить.

Для отримання додаткової інформації перегляньте Forgot_Password_Cheat_Sheet і Choosing_and_Using_Security_Questions_Cheat_Sheet.

Впровадити безпечне зберігання паролів
Щоб забезпечити надійні засоби контролю автентифікації, програма повинна безпечно зберігати облікові дані користувача. Крім того, криптографічний контроль має бути на місці, щоб у разі зламу облікових даних (наприклад, пароля) зловмисник не мав негайного доступу до цієї інформації.

Приклад PHP для зберігання паролів

Нижче наведено приклад безпечного хешування пароля в PHP за допомогою функції password_hash() (доступної з версії 5.5.0), яка за замовчуванням використовує алгоритм bcrypt. У прикладі використовується робочий коефіцієнт 15.

<?php
  $вартість = 15;
  $password_hash = password_hash("секретний_пароль", PASSWORD_DEFAULT,["вартість" => $вартість]);
?>
Будь ласка, перегляньте шпаргалку зберігання паролів OWASP для отримання додаткової інформації.

### Рівень 2: багатофакторна автентифікація
Рівень 2 стандарту NIST 800-63b AAL зарезервовано для додатків із підвищеним ризиком, які містять «індивідуальну інформацію або іншу особисту інформацію, доступну в Інтернеті». На рівні 2 AAL потрібна багатофакторна автентифікація, включаючи OTP або інші форми багатофакторної реалізації.

Багатофакторна автентифікація (MFA) гарантує, що користувачі є тими, за кого себе видають, вимагаючи від них ідентифікації за допомогою комбінації:

Щось, що ви знаєте – пароль або PIN-код
Те, що у вас є – токен або телефон
Щось ви – біометрія, наприклад відбиток пальця
Використання паролів як єдиного фактора забезпечує слабку безпеку. Багатофакторні рішення забезпечують більш надійне рішення, вимагаючи від зловмисника отримати більше ніж один елемент для автентифікації за допомогою служби.

Варто зазначити, що біометрія, якщо вона використовується як єдиний фактор автентифікації, не вважається прийнятним секретом для цифрової автентифікації. Їх можна отримати в Інтернеті або сфотографувати когось за допомогою камери телефону (наприклад, зображення обличчя) з його відома або без нього, зняти з об’єктів, до яких хтось торкається (наприклад, приховані відбитки пальців), або зафіксувати зображення з високою роздільною здатністю (наприклад, райдужна оболонка ока). візерунки). Біометричні дані слід використовувати лише як частину багатофакторної автентифікації за допомогою фізичного автентифікатора (щось, що є у вас). Наприклад, доступ до пристрою з багатофакторним одноразовим паролем (OTP), який згенерує одноразовий пароль, який користувач вручну вводить для верифікатора.

### Рівень 3: Автентифікація на основі криптографії
NIST 800-63b Auth
