## Тестове завантаження файлів неочікуваних типів
|ID|
|----|
|WSTG-BUSL-08|

### Резюме
Багато бізнес-процесів додатків дозволяють завантажувати та маніпулювати даними, які надсилаються через файли. Але бізнес-процес має перевіряти файли та дозволяти лише певні «схвалені» типи файлів. Рішення про те, які файли є «схваленими», визначається бізнес-логікою та залежить від програми/системи. Ризик полягає в тому, що, дозволяючи користувачам завантажувати файли, зловмисники можуть надіслати файл неочікуваного типу, який може бути виконано та негативно вплинути на програму або систему через атаки, які можуть зіпсувати веб-сайт, виконувати віддалені команди, переглядати системні файли, переглядати локальні ресурси, атакувати інші сервери або використовувати локальні вразливості, це лише деякі з них.

Уразливості, пов’язані із завантаженням файлів неочікуваних типів, унікальні тим, що завантаження має швидко відхиляти файл, якщо він не має певного розширення. Крім того, це відрізняється від завантаження шкідливих файлів тим, що в більшості випадків неправильний формат файлу сам по собі не може бути «зловмисним», але може завдати шкоди збереженим даним. Наприклад, якщо програма приймає файли Windows Excel, якщо завантажується подібний файл бази даних, його можна прочитати, але витягнуті дані можна перемістити до неправильних місць.

Програма може очікувати лише певних типів файлів, які будуть завантажені для обробки, як-от файли .csv або .txt. Програма може не перевірити завантажений файл за розширенням (для перевірки файлу з низьким рівнем надійності) або вмістом (перевірка файлу з високим рівнем надійності). Це може призвести до неочікуваних результатів системи або бази даних у програмі/системі або дати зловмисникам додаткові методи використання програми/системи.

### приклад
Припустімо, програма обміну зображеннями дозволяє користувачам завантажувати графічний файл .gif або .jpg на веб-сайт. Що робити, якщо зловмисник зможе завантажити файл HTML із тегом <script> у ньому або файл PHP? Система може перемістити файл із тимчасового розташування в остаточне розташування, де PHP-код тепер можна буде виконати для програми чи системи.

### Цілі тесту
Перегляньте проектну документацію щодо типів файлів, які система відхиляє.
Переконайтеся, що небажані типи файлів відхиляються та обробляються безпечно.
Переконайтеся, що пакетне завантаження файлів є безпечним і не допускає жодного обходу встановлених заходів безпеки.

  ### Як тестувати
- Спеціальний метод тестування
- Вивчіть логічні вимоги програми.
- Підготуйте бібліотеку файлів, які «не схвалені» для завантаження, яка може містити такі файли, як: jsp, exe або файли HTML, що містять сценарій.
- У програмі перейдіть до механізму надсилання або завантаження файлів.
- Надішліть файл «не схвалено» для завантаження та переконайтеся, що його завантаження належним чином заборонено
- Перевірте, чи перевіряє веб-сайт лише тип файлу в JavaScript на стороні клієнта
- Перевірте, чи веб-сайт перевіряє лише тип файлу за «Content-Type» у запиті HTTP.
- Перевірте, чи веб-сайт перевіряє лише розширення файлу.
- Перевірте, чи можна отримати прямий доступ до інших завантажених файлів за вказаною URL-адресою.
- Перевірте, чи може завантажений файл містити код або ін’єкцію сценарію.
- Перевірте, чи існує перевірка шляху до завантажених файлів. Зокрема, хакери можуть стискати файли з указаним шляхом у ZIP, щоб розархівовані файли можна було завантажити за призначеним шляхом після завантаження та розпакування.
- Пов’язані тестові випадки
- Перевірте обробку розширень файлів для конфіденційної інформації
- Тестове завантаження шкідливих файлів

### Санація
Програми слід розробляти з механізмами, щоб приймати та маніпулювати лише «прийнятними» файлами, які решта функціональних можливостей програми готові та очікують. Деякі конкретні приклади включають: заборону списків або дозвіл списків розширень файлів, використання «Content-Type» із заголовка або використання розпізнавача типів файлів, щоб дозволити лише певні типи файлів у системі.
