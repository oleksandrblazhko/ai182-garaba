## Перевірте захист від неправильного використання програми
|ID|
|----|
|WSTG-BUSL-07|

### Резюме
Неправильне та недійсне використання дійсних функцій може виявити атаки, які намагаються перерахувати веб-програму, виявити слабкі місця та використати вразливі місця. Необхідно провести тестування, щоб визначити, чи існують захисні механізми прикладного рівня для захисту програми.

Відсутність активного захисту дозволяє зловмиснику шукати вразливі місця без жодних засобів захисту. Таким чином, власник програми не знатиме, що його програма атакувана.

### приклад
Автентифікований користувач виконує таку (малоймовірну) послідовність дій:

Спроба отримати доступ до ідентифікатора файлу, завантаження якого не дозволено їхнім ролям
Замінює одну позначку ' замість ідентифікаційного номера файлу
Змінює запит GET на POST
Додає додатковий параметр
Дублює пару ім’я/значення параметра
Програма відстежує зловживання та реагує після 5-ї події з надзвичайно високою впевненістю, що користувач є зловмисником. Наприклад додаток:

Відключає критичні функції
Вмикає додаткові кроки автентифікації для інших функцій
Додає часові затримки в кожен цикл запит-відповідь
Починає записувати додаткові дані про взаємодію користувача (наприклад, дезінфіковані заголовки запитів HTTP, тіла та тіла відповіді)
Якщо програма жодним чином не відповідає, а зловмисник може продовжувати зловживати функціями та надсилати явно шкідливий вміст у програму, програма не пройшла цей тест. На практиці дискретні приклади дій у прикладі вище навряд чи відбуватимуться таким чином. Набагато ймовірніше, що інструмент фаззингу використовується для визначення слабких місць у кожному параметрі по черзі. Це те, що тестувальник безпеки також буде виконувати.

### Цілі тесту
Створюйте нотатки з усіх тестів, проведених проти системи.
Перегляньте, які тести мали інші функції на основі агресивного введення.
Зрозумійте наявні засоби захисту та перевірте, чи достатньо їх для захисту системи від методів обходу.
Як тестувати
Цей тест незвичайний тим, що результат можна отримати з усіх інших тестів, проведених щодо веб-програми. Виконуючи всі інші тести, зверніть увагу на заходи, які можуть свідчити про те, що програма має вбудований самозахист:

### Змінені відповіді
Заблоковані запити
Дії, які виводять користувача з системи або блокують його обліковий запис
Вони можуть бути лише локалізовані. Загальні локалізовані (для кожної функції) засоби захисту:

### Відхилення введення, що містить певні символи
Тимчасове блокування облікового запису після кількох помилок автентифікації
Локалізованих заходів безпеки недостатньо. Часто немає засобів захисту від загального неправильного використання, наприклад:

### Примусовий перегляд
- Обхід перевірки вхідних даних рівня презентації
- Кілька помилок контролю доступу
- Додаткові, дубльовані або відсутні імена параметрів
- Кілька помилок перевірки введення або перевірки бізнес-логіки зі значеннями, які не можуть бути результатом помилок користувача або друкарських помилок
- Отримано структуровані дані (наприклад, JSON, XML) недійсного формату
- Отримано відвертий міжсайтовий сценарій або SQL-ін’єкцію
- Використання програми швидше, ніж це було б можливо без засобів автоматизації
- Зміна континентального геолокації користувача
- Зміна агента користувача
- Доступ до багатоетапного бізнес-процесу в неправильному порядку
- Велика кількість або високий рівень використання специфічних для програми функцій (наприклад, надсилання коду ваучера, невдалі платежі кредитною карткою, завантаження файлів, завантаження файлів, вихід із системи тощо).
- Ці засоби захисту найкраще працюють у автентифікованих частинах програми, хоча швидкість створення нових облікових записів або доступу до вмісту (наприклад, для збирання інформації) може бути корисною в публічних місцях.

Програма не потребує моніторингу всього вищезазначеного, але виникає проблема, якщо жодне з них не має. Під час тестування веб-програми, виконуючи вищезазначені дії, чи було вжито будь-якої відповіді проти тестувальника? Якщо ні, тестувальник повинен повідомити, що програма, схоже, не має активного захисту всієї програми від зловживання. Зауважте, що іноді можливо, що всі відповіді на виявлення атак залишаються мовчазними для користувача (наприклад, реєстрація змін, посилений моніторинг, сповіщення адміністраторів і запит проксі-сервера), тому впевненість у цьому висновку не може бути гарантована. На практиці дуже небагато програм (або відповідної інфраструктури, як-от брандмауер веб-програм) виявляють такі типи зловживання.

### Пов’язані тестові випадки
Усі інші тестові випадки актуальні.

### Санація
Програми мають реалізовувати активний захист, щоб захистити себе від зловмисників і порушників.
